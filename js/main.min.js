(function(){function l(a){a.preventDefault();c.classList.add("d-none");var b=a.currentTarget;a=b.getAttribute("data-address");var f=b.getAttribute("data-street-number"),d=b.getAttribute("data-street-name"),n=b.getAttribute("data-ward"),b=b.getAttribute("data-poll");document.getElementById("addressDetails--address").innerText=a;document.getElementById("addressDetails--ward").innerText=n;document.getElementById("addressDetails--poll").innerText=b;var h=document.getElementById("votingLocations--electionDay");
h.innerHTML='<li class="list-group-item">Loading... <i class="fas fa-spinner fa-spin"></i></li>';var m=document.getElementById("votingLocations--advanced");m.innerHTML='<li class="list-group-item">Loading... <i class="fas fa-spinner fa-spin"></i></li>';$.get("voterView.asp",{method:"find_voting_locations",streetNumber:f,streetName:d},"json").done(function(b){m.innerHTML="";0===b.length?h.innerHTML='<li class="list-group-item list-group-item-warning">No voting location found.</li>':(h.innerHTML="",
b.forEach(function(b){var a='<li class="list-group-item"><div class="row">'+('<div class="col-sm">'+b.DateOpenStringLocal+"<br />"+b.StartTime+" to "+b.EndTime+"</div>")+('<div class="col-sm">'+b.LocationName+"<br />"+b.Address1+"</div>")+"</div></li>";b.IsAdvancePoll?m.insertAdjacentHTML("beforeend",a):h.insertAdjacentHTML("beforeend",a)}))});var g=document.getElementById("candidateList--listGroups");g.innerHTML='<p>Loading... <i class="fas fa-spinner fa-spin"></i></p>';var l=function(b,a){return b+
'<li class="list-group-item">'+a.CandidateName+"</li>"};$.get("voterView.asp",{method:"candidate_list",ward:n},"json").done(function(b){g.innerHTML=b.Positions.reduce(function(b,a){return b+'<h4 class="clearfix mt-2"><span class="float-left">'+a.PositionName+'</span> <small class="float-right"><span class="badge badge-secondary">'+a.Candidates.length+" candidate"+(1===a.Candidates.length?"":"s")+'</span> <span class="badge badge-secondary">'+a.NumberPositions+" position"+(1===a.NumberPositions?"":
"s")+'</span></small></h4><ul class="list-group">'+a.Candidates.reduce(l,"")+"</ul>"},"")});p=!0;c.classList.remove("d-none");c.classList.remove("d-sm-none");c.classList.remove("d-xs-none");e.classList.add("d-none");k.value=a;f=e.getElementsByTagName("button");for(d=0;d<f.length;d+=1)f[d].getAttribute("data-address")!==a&&(f[d].outerHTML="",--d)}function g(){var a=k.value;0===a.length?e.innerHTML='<div class="list-group-item list-group-item-info">To get started, enter your address.</div>':$.get("voterView.asp",
{method:"street_addresses",query:a},"json").done(function(b){if(0===b.length)e.innerHTML='<div class="list-group-item list-group-item-danger">There are no addresses available.</div>';else{e.innerHTML=b.reduce(function(b,a){return b+'<button class="list-group-item list-group-item-action" data-address="'+a.Address+'" data-street-number="'+a.StreetNumber+'" data-street-name="'+a.StreetName+'" data-ward="'+a.Ward+'" data-poll="'+a.PollAndSuffix+'" type="button"><div class="clearfix"><strong class="float-left">'+
a.Address+"</strong>"+('<small class="float-right text-right">Ward '+a.Ward+"<br />Poll "+a.PollAndSuffix+"</small>")+"</div></button>"},"");b=e.getElementsByTagName("button");var a;for(a=0;a<b.length;a+=1)b[a].addEventListener("click",l)}}).fail(function(){window.alert("An error occurred communicating with VoterView.  Please refresh your browser and try again.")})}var p=!1,k=document.getElementById("addressForm--query"),e=document.getElementById("addressResults"),c=document.getElementById("addressDetails");
k.addEventListener("focus",function(){e.classList.remove("d-none");p&&(c.classList.add("d-md-block"),c.classList.add("d-lg-block"),c.classList.add("d-xl-block"));c.classList.add("d-sm-none");c.classList.add("d-xs-none")});k.addEventListener("keyup",function(a){a.preventDefault();g()});g();$("#modal--register").on("show.bs.modal",function(){document.getElementById("register--iframe").setAttribute("src","https://vrp.voterview.ca/g/"+document.body.getAttribute("data-county-mun"))})})();
